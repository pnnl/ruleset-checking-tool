# Section 19 - Rule 19-23           
**Schema Version:** 0.0.23    
**Mandatory Rule:** True    
**Rule ID:** 19-23         
**Rule Description:** The calculated system fan power shall be distributed to supply, return, exhaust, and relief fans in the same proportion as the proposed design.   

**Rule Assertion:** Options are Pass/Fail    
**Appendix G Section:** G3.1.2.10 and exceptions 1-7        
**90.1 Section Reference:** None  

**Data Lookup:** None  

**Evaluation Context:** Each HeatingVentilatingAirConditioningSystem  

**Applicability Checks:** None   

**Function Calls:**  
1. get_dict_of_zones_and_terminal_units_served_by_hvac_sys()   
2. get_list_hvac_systems_associated_with_zone()   
3. get_fan_object_electric_power()  
4. get_fan_system_object_supply_return_exhaust_relief_total_kW_CFM() 


****Need to account for the fact that the supply fan is defined at the terminal unit for some types of systems****
## Rule Logic:                 
- Create dictionary of hvac systems and associated zones and terminal units: `dict_get_dict_of_zones_and_terminal_units_served_by_hvac_sys_p = get_dict_of_zones_and_terminal_units_served_by_hvac_sys(P_RMI)`
- Create dictionary of hvac systems, zones, and terminal units: `dict_of_zones_and_terminal_units_served_by_hvac_sys_p = get_dict_of_zones_and_terminal_units_served_by_hvac_sys(P_RMI)`  

Create a dictionary with each zone as the key and a list with supply, return, exhaust, relief, terminal fan power 
- For each Zone in the P_RMI: `for zone in P_RMI...Zone:`  
    - Reset the zone total terminal fan power variable: `zone_total_terminal_fan_power = 0`  
    - Reset the zone total supply fan power variable: `zone_total_supply_fan_power = 0`
    - Reset the zone total return fan power variable: `zone_total_return_fan_power = 0`
    - Reset the zone total relief fan power variable: `zone_total_relief_fan_power = 0`
    - Reset the zone total exhaust fan power variable: `zone_total_exhaust_fan_power = 0`

    - Get a list of HVAC systems serving the zone: `hvac_sys_list_serving_zone_p =  get_list_hvac_systems_associated_with_zone(P_RMI,zone.id)`  
    - For each hvac system serving the zone: `for hvac in hvac_sys_list_serving_zone_p:`  
      - Reset total_terminal_air_flow variable to 0: `total_terminal_air_flow = 0`  
      - Reset the zone_primary_air_flow variable to 0: `zone_primary_air_flow = 0`  
      - Check if there is a fan system associated with the hvac system (if not then assume the fan is defined at the terminal unit): `if hvac.fan_system != Null:` 
        - Get list of zones served by the hvac system: `zone_list_hvac_sys_p = dict_get_dict_of_zones_and_terminal_units_served_by_hvac_sys_p[hvac.id]["ZONE_LIST"]`  
        - Get list of terminal units served by the hvac system: `terminal_list_hvac_sys_p = dict_get_dict_of_zones_and_terminal_units_served_by_hvac_sys_p[hvac.id]["ZONE_LIST"]["Terminal_Unit_List"]`  
        - For each terminal unit served by the HVAC system: `for terminal in terminal_list_hvac_sys_p:`  
          - Get the primary air flow: `primary_air_flow_terminal = terminal.primary_airflow`  
          - Add to the total cfm across all terminals served by the HVAC system: `total_terminal_air_flow = total_terminal_air_flow + primary_air_flow_terminal`  
          - Get the terminal unit fan power: `terminal_fan_power = get_fan_object_electric_power(P_RMI,terminal.fan)`  
          - Add to the total terminal kW across all terminals served by the HVAC system: `zone_total_terminal_fan_power = zone_total_terminal_fan_power + terminal_fan_power`
          - Check if the terminal unit is associated with this zone, if so then add to the primary flow for the zone for this hvac system: `if terminal in zone.terminals: zone_primary_air_flow = zone_primary_air_flow + primary_air_flow_terminal`  
        
        - Get dictionary of the fan system's supply, return, exhaust and relief fan powers in kW: `fan_sys_kW = list(get_fan_system_object_supply_return_exhaust_relief_total_kW_CFM(P_RMI,hvac.fan_system)["Fan_Power"])`  
        - Get the hvac system total supply fan kW, need to get the first element in the list of fan powers:`hvac_sys_total_supply_fan_power = fan_sys_kW[0]` 
        - Get the hvac system total return fan kW, need to get the second element in the list of fan powers:`hvac_sys_total_return_fan_power = fan_sys_kW[1]` 
        - Get the hvac system total exhaust fan kW, need to get the third element in the list of fan powers:`hvac_sys_total_exhaust_fan_power = fan_sys_kW[2]` 
        - Get the hvac system total relief fan kW, need to get the fourth element in the list of fan powers:`hvac_sys_total_relief_fan_power = fan_sys_kW[3]`     
        
        - Apportion the supply kW to this zone based on the terminal unit primary flow for the zone and the total primary terminal unit flow across all zones that this HVAC system serves: `zone_total_supply_fan_power = zone_total_supply_fan_power + (hvac_sys_total_supply_fan_power * (zone_primary_air_flow/total_terminal_air_flow))`    
        - Apportion the return kW to this zone based on the terminal unit primary flow for the zone and the total primary terminal unit flow across all zones that this HVAC system serves: `zone_total_return_fan_power = zone_total_return_fan_power + (hvac_sys_total_return_fan_power * (zone_primary_air_flow/total_terminal_air_flow))`  
        - Apportion the exhaust kW to this zone based on the terminal unit primary flow for the zone and the total primary terminal unit flow across all zones that this HVAC system serves: `zone_total_exhaust_fan_power = zone_total_exhaust_fan_power + (hvac_sys_total_exhaust_fan_power * (zone_primary_air_flow/total_terminal_air_flow))`  
        - Apportion the relief kW to this zone based on the terminal unit primary flow for the zone and the total primary terminal unit flow across all zones that this HVAC system serves: `zone_total_relief_fan_power = zone_total_relief_fan_power + (hvac_sys_total_relief_fan_power * (zone_primary_air_flow/total_terminal_air_flow))`  
    - Else, the hvac fan system equals Null meaning that the fan is defined at the terminal unit level: `Else:`  
        - Get list of zones served by the hvac system: `zone_list_hvac_sys_p = dict_get_dict_of_zones_and_terminal_units_served_by_hvac_sys_p[hvac.id]["ZONE_LIST"]`  
        - Get list of terminal units served by the hvac system: `terminal_list_hvac_sys_p = dict_get_dict_of_zones_and_terminal_units_served_by_hvac_sys_p[hvac.id]["ZONE_LIST"]["Terminal_Unit_List"]`  
        - For each terminal unit served by the HVAC system: `for terminal in terminal_list_hvac_sys_p:`  
          - Check if the terminal unit is associated with this zone, if so then add the fan power associated with the terminal unit to the zone total supply fan power: `if terminal in zone.terminals: `  
            - Get the terminal unit fan power: `terminal_fan_power = get_fan_object_electric_power(P_RMI,terminal.fan)`  
            - Add to the total terminal kW across all terminals served by the HVAC system: `zone_total_terminal_fan_power = zone_total_terminal_fan_power + terminal_fan_power`
            - Add to the zone total supply fan power since it is a supply fan defined at the terminal: `zone_total_supply_fan_power = zone_total_supply_fan_power + get_fan_object_electric_power(P_RMI,terminal.fan)`  


    - **Rule Assertion:** 
    - Case 1: If OA_fraction >= 70% and supply_cfm_b >= 5000 and ER_modeled = True and enthalpy_rec_ratio = 50%: Pass: `if OA_fraction >= 70% and supply_cfm_b >= 5000 and ER_modeled == True and enthalpy_rec_ratio == 50%: outcome = "PASS"`  
  `  
    - Case : Else, fail: `Else: outcome = "Fail"`  

**Notes/Questions:**  


**[Back](_toc.md)**