# Section 19 - Rule 19-23           
**Schema Version:** 0.0.23    
**Mandatory Rule:** True    
**Rule ID:** 19-23         
**Rule Description:** The calculated system fan power shall be distributed to supply, return, exhaust, and relief fans in the same proportion as the proposed design.   

**Rule Assertion:** Options are Pass/Fail    
**Appendix G Section:** G3.1.2.10 and exceptions 1-7        
**90.1 Section Reference:** None  

**Data Lookup:** None  

**Evaluation Context:** Each HeatingVentilatingAirConditioningSystem  

**Applicability Checks:** None   

**Function Calls:**  
1. get_dict_of_zones_and_terminal_units_served_by_hvac_sys()   
2. get_list_hvac_systems_associated_with_zone()   
3. get_fan_object_electric_power()  


## Rule Logic:                 
- Create dictionary of hvac systems and associated zones and terminal units: `dict_get_dict_of_zones_and_terminal_units_served_by_hvac_sys_p = get_dict_of_zones_and_terminal_units_served_by_hvac_sys(P_RMI)`
- Create dictionary of hvac systems, zones, and terminal units: `dict_of_zones_and_terminal_units_served_by_hvac_sys_p = get_dict_of_zones_and_terminal_units_served_by_hvac_sys(P_RMI)`  

Create a dictionary with each zone as the key and a list with supply, return, exhaust, relief, terminal fan power 
- For each Zone in the P_RMI: `for zone in P_RMI...Zone:`  
    - Reset the zone total terminal fan power variable: `zone_total_terminal_fan_power = 0`  
    - Reset the zone total supply fan power variable: `zone_total_supply_fan_power = 0`
    - Reset the zone total return fan power variable: `zone_total_return_fan_power = 0`
    - Reset the zone total relief fan power variable: `zone_total_relief_fan_power = 0`
    - Reset the zone total exhaust fan power variable: `zone_total_exhaust_fan_power = 0`

    - Get a list of HVAC systems serving the zone: `hvac_sys_list_serving_zone_p =  get_list_hvac_systems_associated_with_zone(P_RMI,zone.id)`  
    - For each hvac system serving the zone: `for hvac in hvac_sys_list_serving_zone_p:`  
      - Reset total_terminal_air_flow variable to 0: `total_terminal_air_flow = 0`  
      - Reset the zone_primary_air_flow variable to 0: `zone_primary_air_flow = 0`  
      - Get list of zones served by the hvac system: `zone_list_hvac_sys_p = dict_get_dict_of_zones_and_terminal_units_served_by_hvac_sys_p[hvac.id]["ZONE_LIST"]`  
      - Get list of terminal units served by the hvac system: `terminal_list_hvac_sys_p = dict_get_dict_of_zones_and_terminal_units_served_by_hvac_sys_p[hvac.id]["ZONE_LIST"]["Terminal_Unit_List"]`  
      - For each terminal unit served by the HVAC system: `for terminal in terminal_list_hvac_sys_p:`  
        - Get the primary air flow: `primary_air_flow_terminal = terminal.primary_airflow`  
        - Add to the total across all terminals served by the HVAC system: `total_terminal_air_flow = total_terminal_air_flow + primary_air_flow_terminal`  
        - Get the terminal unit fan power (I don't think this is needed): `fan_power_terminal = get_fan_object_electric_power(P_RMI,terminal.fan)`  
        - Add to the total cross all terminals served by the HVAC system (I don't think this is needed): `total_terminal_fan_power = total_terminal_fan_power + fan_power_terminal`  
        - Check if the terminal unit is associated with this zone, if so then add to the primary flow for the zone for this hvac system: `if terminal in zone.terminals: zone_primary_air_flow = zone_primary_air_flow + primary_air_flow_terminal`  


************function***************
# get_fan_system_object_supply_return_exhaust_relief_total_kW_CFM

**Description:** Get the supply, return, exhaust, and relief total fan power and CFM associated with a fan system object.   

**Inputs:**  
- **B-RMI,P-RMI**: To calculate the supply, return, exhaust, and relief total fan power and CFM associated with a fan system object sent to this function.   
- **fan_system_obj**: The fan system object sent to this function.  

**Returns:**  
- **get_fan_system_object_supply_return_exhaust_relief_total_kW_CFM**: The function calculates and return the supply, return, exhaust, and relief total fan power and CFM associated with the fan system object sent to this function. The function returns a dictionary that saves the supply, return, exhaust, and relief fan power has a list and the saves the supply, return, exhaust, and relief cfm as a list {"Fan_Power": [supply fan power kW, return fan power kW, exhaust fan power kW, relief fan power kW], "Fan_CFM": [supply fan power CFM, return fan power CFM, exhaust fan power CFM, relief fan power CFM]}. Values will be equal to zero where not defined for a fan system.
 
**Function Call:**  
1. get_fan_object_electric_power 


## Logic:    
- Reset total fan power to zero: `total_fan_power = 0`  
- Reset total cfm to zero: `total_fan_cfm = 0`  
- Check if there are any fan objects associated with the fan system's supply fans:`if len(fan_system_obj.supply_fans) != 0 and fan_system_obj.supply_fans != Null:`  
  - Loop through the supply fan: `for fan_obj in fan_system_obj.supply_fans:`  
    - Set the fan_elec_power equal to zero: `fan_elec_power = 0`
    - Set the fan_cfm equal to zero: `fan_cfm = 0`
    - Get the fan objects total kW: `fan_elec_power = get_fan_object_electric_power(P_RMI, fan_obj)`  
    - Add to the total associated with this fan system: `total_fan_power = total_fan_power + fan_elec_power`  
    - Get the fan cfm: `fan_cfm = fan_obj.design_airflow`  
    - Add to the total associated with this fan system: `total_fan_cfm = total_fan_cfm + fan_cfm`   
- Fan system supply cfm equals total_fan_cfm: `fan_sys_supply_cfm = total_fan_cfm` 
- Fan system electric power kW equals total_fan_power: `fan_sys_supply_kW = total_fan_power` 

- Reset total fan power to zero: `total_fan_power = 0`  
- Reset total cfm to zero: `total_fan_cfm = 0`  
- Check if there are any fan objects associated with the fan system's return fans:`if len(fan_system_obj.return_fans) != 0 and fan_system_obj.return_fans != Null:`  
  - Loop through the return fan: `for fan_obj in fan_system_obj.return_fans:`  
    - Set the fan_elec_power equal to zero: `fan_elec_power = 0`
    - Set the fan_cfm equal to zero: `fan_cfm = 0`
    - Get the fan objects total kW: `fan_elec_power = get_fan_object_electric_power(P_RMI, fan_obj)`  
    - Add to the total associated with this fan system: `total_fan_power = total_fan_power + fan_elec_power`  
    - Get the fan cfm: `fan_cfm = fan_obj.design_airflow`  
    - Add to the total associated with this fan system: `total_fan_cfm = total_fan_cfm + fan_cfm`   
- Fan system return cfm equals total_fan_cfm: `fan_sys_return_cfm = total_fan_cfm` 
- Fan system electric power kW equals total_fan_power: `fan_sys_return_kW = total_fan_power` 

- Reset total fan power to zero: `total_fan_power = 0`  
- Reset total cfm to zero: `total_fan_cfm = 0`  
- Check if there are any fan objects associated with the fan system's exhaust fans:`if len(fan_system_obj.exhaust_fans) != 0 and fan_system_obj.exhaust_fans != Null:`  
  - Loop through the exhaust fan: `for fan_obj in fan_system_obj.exhaust_fans:`  
    - Set the fan_elec_power equal to zero: `fan_elec_power = 0`
    - Set the fan_cfm equal to zero: `fan_cfm = 0`
    - Get the fan objects total kW: `fan_elec_power = get_fan_object_electric_power(P_RMI, fan_obj)`  
    - Add to the total associated with this fan system: `total_fan_power = total_fan_power + fan_elec_power`  
    - Get the fan cfm: `fan_cfm = fan_obj.design_airflow`  
    - Add to the total associated with this fan system: `total_fan_cfm = total_fan_cfm + fan_cfm`   
- Fan system exhaust cfm equals total_fan_cfm: `fan_sys_exhaust_cfm = total_fan_cfm` 
- Fan system electric power kW equals total_fan_power: `fan_sys_exhaust_kW = total_fan_power` 

- Reset total fan power to zero: `total_fan_power = 0`  
- Reset total cfm to zero: `total_fan_cfm = 0`  
- Check if there are any fan objects associated with the fan system's relief fans:`if len(fan_system_obj.relief_fans) != 0 and fan_system_obj.relief_fans != Null:`  
  - Loop through the relief fan: `for fan_obj in fan_system_obj.relief_fans:`  
    - Set the fan_elec_power equal to zero: `fan_elec_power = 0`
    - Set the fan_cfm equal to zero: `fan_cfm = 0`
    - Get the fan objects total kW: `fan_elec_power = get_fan_object_electric_power(P_RMI, fan_obj)`  
    - Add to the total associated with this fan system: `total_fan_power = total_fan_power + fan_elec_power`  
    - Get the fan cfm: `fan_cfm = fan_obj.design_airflow`  
    - Add to the total associated with this fan system: `total_fan_cfm = total_fan_cfm + fan_cfm`   
- Fan system relief cfm equals total_fan_cfm: `fan_sys_relief_cfm = total_fan_cfm` 
- Fan system electric power kW equals total_fan_power: `fan_sys_relief_kW = total_fan_power` 

- Create dictionary: `get_fan_system_object_supply_return_exhaust_relief_total_kW_CFM = {"Fan_Power": [fan_sys_supply_kW,fan_sys_return_kW,fan_sys_exhaust_kW,fan_sys_relief_kW], "Fan_CFM": [fan_sys_supply_cfm,fan_sys_return_cfm,fan_sys_exhaust_cfm,fan_sys_relief_cfm]}` 

**Returns** `get_fan_system_object_supply_return_exhaust_relief_total_kW_CFM`  

**Questions:**  

**[Back](../_toc.md)**


***********************************


Add function for getting supply, return, exhsuat, and relief fan power for an HVAC system? Make a list. Or that creates a dictionary with all HVAC systems, the fan power, and also the cfm for each of those fans?
            
    - **Rule Assertion:** 
    - Case 1: If OA_fraction >= 70% and supply_cfm_b >= 5000 and ER_modeled = True and enthalpy_rec_ratio = 50%: Pass: `if OA_fraction >= 70% and supply_cfm_b >= 5000 and ER_modeled == True and enthalpy_rec_ratio == 50%: outcome = "PASS"`  
  `  
    - Case : Else, fail: `Else: outcome = "Fail"`  

**Notes/Questions:**  


**[Back](_toc.md)**