s# HVAC_SystemZoneAssignment - Rule 11-10

**Schema Version:** 0.0.36  
**Mandatory Rule:** True  
**Rule ID:** 11-10  

**Rule Description:** "The service water heating system type in the baseline building design shall match the minimum efficiency requirements in Section 7.4.2"  

**Rule Assertion:** Options are PASS/FAIL/NOT_APPLICABLE/UNDETERMINED  
**Appendix G Section Reference:** Table G3.1 #11, baseline column, a + b  

**Evaluation Context:** Each ServiceWaterHeatingEquipment  
**Data Lookup:**   
**Function Call:**

1. get_SHW_equipment_associated_with_each_SWH_bat()
2. get_SHW_types_and_SHW_use()

**Applicability Checks:**
- Each SHW BAT is applicable if there are SHW loads
- use get_SHW_equipment_associated_with_each_SWH_bat to get the SHW BATs and SHW use in the building: `shw_bats_and_equip_dict = get_SHW_equipment_associated_with_each_SWH_bat(B_RMD)`

- call the function get_SHW_types_and_SHW_use for the proposed: `shw_bat_and_use_dict_p = get_SHW_types_and_SHW_use(P_RMD)`
- look through each of the SHW bats in the building: `for shw_bat in shw_bat_and_use_dict_p:`
  - check if there are SHW loads in this BAT, continue to rule logic: `if len(shw_bat_and_use_dict_p[shw_bat]) > 0: CONTINUE TO RULE LOGIC`
  - otherwise, rule is not applicable for this shw_bat: `else: NOT_APPLICABLE`


    ## Rule Logic:
  - create a value to track the rule status: `rule_status = "FAIL"`
  - create a variable to track any notes: `rule_note = """`
  - there should be one SHW Equipment for this BAT: `if len(shw_types_and_use_dict[shw_bat]["SHWHeatingEq"]) != 1:`
    - set rule_note to "more than one ServiceWaterHeatingEquipment" `rule_note = "more than one ServiceWaterHeatingEquipment"`
  - otherwise, do the calculations to figure out if the SWH equipment meets the requirements of the rule: `else:`
    - get the service water heating equipment id: `service_water_heating_equipment_id = shw_equip_dict[shw_bat]["SHWHeatingEq"]`
    - we need to find the following information about the SWH:
      - type - (ELECTRIC_RESISTANCE_INSTANTANEOUS, ELECTRIC_RESISTANCE_STORAGE, GAS_STORAGE, OTHER)
      - swh_type - one of the SWH BATs
      - input_capacity (btu/hr)
      - storage_volume (gallons)
      - draw_pattern (VERY_SMALL, LOW, MEDIUM, or HIGH)
      - capacity_per_volume (btu/hr/gallon)
    - get the service water heating system: `swh_eq = get_object_by_id(service_water_heating_equipment_id,RMD)`
    - get the type of tank: `tank_type = swh_eq.tank.type`
    - get the type of heater: `swh_type = swh_eq.heater_type`
    - the type will be one of the ServiceWaterHeaterTankOptions, which are more detailed than the four types we need.  Determine our type based on the detailed type.
    - set the type to OTHER.  If the tank_type is an identifiable type, type will be overwritten to that type: `type = "OTHER"`
    - if the tank_type is CONSUMER_INSTANTANEOUS, COMMERCIAL_INSTANTANEOUS, or RESIDENTIAL_DUTY_COMMERCIAL_INSTANTANEOUS, set the type to INSTANTANEOUS and go to rule assertion: `if tank_type in ["CONSUMER_INSTANTANEOUS", "COMMERCIAL_INSTANTANEOUS", "RESIDENTIAL_DUTY_COMMERCIAL_INSTANTANEOUS"]: type = "INSTANTANEOUS"`; GO TO RULE_ASSERTION

    - get the fuel type of the equipment: `fuel_type = shw_eq.heater_fuel_type`
    - if the tank_type is CONSUMER_STORAGE or COMMERCIAL_STORAGE, set the type to STORAGE for the fuel type: `if tank_type in ["CONSUMER_STORAGE", "COMMERCIAL_STORAGE"]:`
      - set the type based on tank_type and fuel type: `if fuel_type == "ELECTRICITY": type = "ELECTRIC_RESISTANCE_STORAGE`
      - `elif fuel_type == "NATURAL_GAS": type = "GAS_STORAGE`
      - `elif fuel_type == "FUEL_OIL": type = "OIL_STORAGE`
    - if the draw_pattern is given, get the draw pattern: `if shw_eq.draw_pattern != nil: draw_pattern = shw_eq.draw_pattern`
    - otherwise, determine the draw pattern based off the first_hour_rating of the shw_eq: `else:`
      - First get the first hour rating (gallons): `first_hour_rating = shw_eq.first_hour_rating`
      - if the first_hour_rating is less than 18 gallons, draw_pattern is "VERY SMALL": `if first_hour_rating < 18: draw_pattern = "VERY_SMALL"`
      - otherwise if the first_hour_rating is less than 51 gallons, draw pattern is LOW: `elif first_hour_rating < 51: draw_pattern = "LOW"`
      - otherwise if the first_hour_rating is less than 75 gallons, draw pattern is MEDIUM: `elif first_hour_rating < 75: draw_pattern = "MEDIUM"`
      - otherwise draw pattern is HIGH: `else: draw_pattern = "HIGH"`
    - get the capacity of the SHW system (make sure to convert to btu/hr): `input_capacity = swh_eq.input_power`
    - get the volume of the tank (make sure to convert to gallons): `storage_volume = swh_eq.distribution_system.tank.storage_capacity`
    - calculate the capacity_per_volume based on the input_capacity and the storage_volume: `capacity_per_volume = shw_eq.rated_capacity / storage_volume`
    - get the standby loss (see note 1 for calculation source): `standby_loss = swh_eq.standby_loss_fraction * 8.25 * volume * 70`
    - what follows is logic that implements Table 7.8 - this table has multiple criteria, so I think it's simpler to implement with if / else logic than a table lookup
    - if the type is OTHER, set rule_note to "Water heater type is not a recognized type": `if type == "OTHER": rule_note = "Water heater type is not a recognized type"`
    - otherwise, continue with rule logic: `else:`
      - create a boolean has_fault and set it to false: `has_fault = false`
      - if the water heater is electric resistance, or storage and the capacity is <= 12kW (40945 btu/hr), look at Appendix F: `if type in ["ELECTRIC_RESISTANCE_STORAGE"] && input_capacity <= 40945.7:`
        - check the size of the storage tank.  If it's less than 2 gallons: `if storage_volume < 2:`
          - if the draw pattern is HIGH, the expected UEF is 0.92, for draw all draw patterns other draw patterns, it is 0.91: `if draw_pattern == "HIGH": expected_UEF = 0.92; else: expected_UEF = 0.91`
          - check if the actual uniform_energy_factor is >= to the expected: `if shw_eq.uniform_energy_factor >= expected_UEF:`
            - set rule_status to "PASS": `rule_status = "PASS"`
          - otherwise, set rule status to FAIL and provide the note that the expected UEF is less than the required UEF: `else: rule_status = "FAIL"; rule_note = "The modeled Uniform energy Factor (UEF - " + shw_eq.uniform_energy_factor + ") is less than required (" + expected_UEF + ")"`
        - else, if the storage tank is is between 20 and 55 gallons, this is considered an electric storage water heater in Appendix F: `elif storage_volume >= 20 && storage_volume <= 55:`
          - determine the UEF based on the draw pattern for VERY_SMALL: `if draw_pattern == "VERY_SMALL": expected_uef = 0.8808 – (0.0008 × storage_volume)`
          - determine the UEF based on the draw pattern for LOW: `if draw_pattern == "LOW": expected_uef = 0.9254 – (0.0003 × storage_volume)`
          - determine the UEF based on the draw pattern for MEDIUM: `if draw_pattern == "MEDIUM": expected_uef = 0.9307 – (0.0002 × storage_volume)`
          - determine the UEF based on the draw pattern for HIGH: `if draw_pattern == "HIGH": expected_uef = 0.9349 – (0.0001 × storage_volume)` 
          - check if the actual uniform_energy_factor is >= to the expected: `if shw_eq.uniform_energy_factor >= expected_UEF:`
            - set rule_status to "PASS": `rule_status = "PASS"`
          - otherwise, set rule status to FAIL and provide the note that the expected UEF is less than the required UEF: `else: rule_status = "FAIL"; rule_note = "The modeled Uniform energy Factor (UEF - " + shw_eq.uniform_energy_factor + ") is less than required (" + expected_UEF + ")"`
        - else, if the storage tank is greater than 55 and less than 100 gallons, Appendix F provides a heat pump efficiency, or the storage volume is between 2 and 20 gallons, in which case there is no rating in APPENDIX F.  return UNDETERMINED: `else:`
          - set rule_status to UNDETERMINED: `rule_status = "UNDETERMINED"`
      - otherwise, continue with rule logic: `else:`
        - check electric storage water heaters with capacity greater than 12 kW: `if type == "ELECTRIC_RESISTANCE_STORAGE" && input_capacity > 40945.7:`
          - check that the capacity_per_volume < 4000 btu/hr/gallon: `if capacity_per_volume < 4000:`
            - calculate the standby loss target: `standby_loss_target = 0.3 + (27/swh_eq.distribution_system.tank.storage_volume)` 
            - if the standby_loss is less than or equal to the target, set the rule_status to PASS: `if standby_loss <= standby_loss_target: rule_status: "PASS"`
            - otherwise: `else:`
              - set the note to indicate that the standby_loss is higher than the maximum allowed: `rule_note = "Standby Loss is higher than required by Table 7.8"`
          - otherwise: `else:`
            - set the note to indicate that the capacity per volume exceeds the limit: `rule_note = "Capacity per volume exceeds the limit of 4000 btu/hr/gallon for Electric Storage Water Heaters` 
        - check if the water heater is gas storage: `if type == "GAS_STORAGE":`
          - check if the capacity is <= 75,000 btu/hr: `if input_capacity <= 75000:`
            - if the storage volume is between 20 and 55 gallons: `if storage_volume >= 20 && storage_volume <= 55:`
              - determine the UEF based on the draw pattern for VERY_SMALL: `if draw_pattern == "VERY_SMALL": expected_uef = 0.3456 – (0.0020 × storage_volume)`
              - determine the UEF based on the draw pattern for LOW: `if draw_pattern == "LOW": expected_uef = 0.5982 – (0.0019 × storage_volume)`
              - determine the UEF based on the draw pattern for MEDIUM: `if draw_pattern == "MEDIUM": expected_uef = 0.6483 – (0.0017 × storage_volume)`
              - determine the UEF based on the draw pattern for HIGH: `if draw_pattern == "HIGH": expected_uef = 0.6920 – (0.0013 × storage_volume)` 
              - check if the actual uniform_energy_factor is >= to the expected: `if shw_eq.uniform_energy_factor >= expected_UEF:`
                - set rule_status to "PASS": `rule_status = "PASS"`
              - otherwise, set rule status to FAIL and provide the note that the expected UEF is less than the required UEF: `else: rule_status = "FAIL"; rule_note = "The modeled Uniform energy Factor (UEF - " + shw_eq.uniform_energy_factor + ") is less than required (" + expected_UEF + ")"`
            - otherwise, if the storage volume is between 55 and 100 gallons: `elif storage_volume <= 100:`
              - determine the UEF based on the draw pattern for VERY_SMALL: `if draw_pattern == "VERY_SMALL": expected_uef = 0.6470 – (0.0006 × storage_volume)`
              - determine the UEF based on the draw pattern for LOW: `if draw_pattern == "LOW": expected_uef = 0.7689 – (0.0005 × storage_volume)`
              - determine the UEF based on the draw pattern for MEDIUM: `if draw_pattern == "MEDIUM": expected_uef = 0.7897 – (0.0004 × storage_volume)`
              - determine the UEF based on the draw pattern for HIGH: `if draw_pattern == "HIGH": expected_uef = 0.8072 – (0.0003 × storage_volume)` 
              - check if the actual uniform_energy_factor is >= to the expected: `if shw_eq.uniform_energy_factor >= expected_UEF:`
                - set rule_status to "PASS": `rule_status = "PASS"`
              - otherwise, set rule status to FAIL and provide the note that the expected UEF is less than the required UEF: `else: rule_status = "FAIL"; rule_note = "The modeled Uniform energy Factor (UEF - " + shw_eq.uniform_energy_factor + ") is less than required (" + expected_UEF + ")"`
            - otherwise, the storage volume is either greater than 100 gallons, or between 2 and 20, which is not covered by Appendix F: `else:`
              - create a note indicating that gas water heaters greater with input capacity < 75,000 btu/hr and the given storage volume are not covered under Appendix F: `rule_note: "Gas water heaters with an input capacity < 75,000 btu/hr and a storage capacity of " + storage_volume + " are not covered under Appendix F"`
              - change rule_status to UNDETERMINED: `rule_status = "UNDETERMINED"`
          - check if the capacity <= 105,000 btu/hr: `elif input_capacity <= 105000:`
            - the capacity per volume should be < 4000 btu/hr/gallon: `if capacity_per_volume > 4000:`
              - add the following text to the note: "For Gas Storage Water heaters, the capacity per volume should be less than 4000 btu/hr/gallon": `rule_note += "For Gas Storage Water heaters, the capacity per volume should be less than 4000 btu/hr/gallon.  "`
              - set has_fault to true: `has_fault = true`
            - the volume should be <= 120 gallons: `if storage_volume > 120:`
              - add the following text to the note: "For Gas Storage Water heaters with capacity less than 105,000 btu/hr, the storage capacity is expected to be less than 120 gallons": `rule_note += "For Gas Storage Water heaters with capacity less than 105,000 btu/hr, the storage capacity is expected to be less than 120 gallons.  "`
              - set has_fault to true: `has_fault = true`
            - the supply water temperature should be <= 180F: `if shw_eq.setpoint_temperature > 180:`
              - add the following text to the note: "For Gas Storage Water heaters with capacity less than 105,000 btu/hr, the supply water temperature is expected to be <= 180F": `rule_note += "For Gas Storage Water heaters with capacity less than 105,000 btu/hr, the supply water temperature is expected to be <= 180F.  "`
              - set has_fault to true: `has_fault = true`
            - calculate the expected efficiency for VERY_SMALL draw pattern: `if draw_pattern == "VERY_SMALL": expected_UEF = 0.2674 – (0.0009 * volume)`
            - calculate the expected efficiency for LOW draw pattern: `if draw_pattern == "LOW": expected_UEF = 0.5362 – (0.0012 * volume)`
            - calculate the expected efficiency for MEDIUM draw pattern: `if draw_pattern == "MEDIUM": expected_UEF = 0.6002 – (0.0011 * volume)`
            - calculate the expected efficiency for HIGH draw pattern: `if draw_pattern == "HIGH": expected_UEF = 0.6597 – (0.0009 * volume)`
            - check if the actual uniform_energy_factor is >= to the expected: `if shw_eq.uniform_energy_factor >= expected_UEF && !has_faults:`
              - set rule_status to "PASS": `rule_status = "PASS"`
          - otherwise the capacity is > 105,000 btu/hr: `else:`
            - the capacity per volume should be < 4000 btu/hr/gallon: `if capacity_per_volume > 4000:`
              - add the following text to the note: "For Gas Storage Water heaters, the capacity per volume should be less than 4000 btu/hr/gallon": `rule_note += "For Gas Storage Water heaters, the capacity per volume should be less than 4000 btu/hr/gallon.  "`
              - set has_fault to true: `has_fault = true`
            - calculate the expected_thermal_efficiency : `expected_thermal_efficiency = 0.8`
            - calculate max_standby_loss (btu/hr): `max_standby_loss = (input_capacity/800 + 110 * sqrt(volume))`
            - check if the actual uniform_energy_factor is >= to the expected: `if shw_eq.thermal_efficiency >= expected_thermal_efficiency && standby_loss <= max_standby_loss && !has_faults:`
              - set rule_status to "PASS": `rule_status = "PASS"`
        - check if the water heater is OIL_STORAGE: `elif type == "OIL_STORAGE`
          - if the input capacity < 105,000 btu/hr, this equipment is covered under Appendix F: `if input_capacity < 105000:`
            - look to see if the water heater is covered in Appendix F, first look to see if it is anything less than 50 gallons of storage: `if storage_volume < 50:`
              - determine the UEF based on the draw pattern for VERY_SMALL: `if draw_pattern == "VERY_SMALL": expected_uef = 0.2509 – (0.0012 × storage_volume)`
              - determine the UEF based on the draw pattern for LOW: `if draw_pattern == "LOW": expected_uef = 0.5330 – (0.0016 × storage_volume)`
              - determine the UEF based on the draw pattern for MEDIUM: `if draw_pattern == "MEDIUM": expected_uef = 0.6078 – (0.0016 × storage_volume)`
              - determine the UEF based on the draw pattern for HIGH: `if draw_pattern == "HIGH": expected_uef = 0.6815 – (0.0014 × storage_volume)` 
              - check if the actual uniform_energy_factor is >= to the expected: `if shw_eq.uniform_energy_factor >= expected_UEF:`
                - set rule_status to "PASS": `rule_status = "PASS"`
              - otherwise, set rule status to FAIL and provide the note that the expected UEF is less than the required UEF: `else: rule_status = "FAIL"; rule_note = "The modeled Uniform energy Factor (UEF - " + shw_eq.uniform_energy_factor + ") is less than required (" + expected_UEF + ")"`
            - otherwise, the storage volume is greater 50 gallons and is not covered by Appendix F: `else:`
              - create a note indicating that gas water heaters with storage volume greater than 50 gallons are not covered under Appendix F: `rule_note: "Gas water heaters with a storage volume greater than 50 gallons are not covered under Appendix F"`
              - change rule_status to UNDETERMINED: `rule_status = "UNDETERMINED"`
          - else if the input capacity is < 140,000 btu/hr: `elif input_capacity < 140000:`
            - calculate the expected efficiency for VERY_SMALL draw pattern: `if draw_pattern == "VERY_SMALL": expected_UEF = 0.2932 – (0.0015 * volume)`
            - calculate the expected efficiency for LOW draw pattern: `if draw_pattern == "LOW": expected_UEF = 0.5596 – (0.0018 * volume)`
            - calculate the expected efficiency for MEDIUM draw pattern: `if draw_pattern == "MEDIUM": expected_UEF = 0.6194 – (0.0016 * volume)`
            - calculate the expected efficiency for HIGH draw pattern: `if draw_pattern == "HIGH": expected_UEF = 0.6740 – (0.0013 * volume)`
            - check that the storage volume is <= 120 gallons: `if volume > 120 gallons:`
              - add the following text to the note: "For Oil Storage heaters, with capacity < 140,000 btu/hr, the storage volume should be <= 120 gallons.": `rule_note += "For Oil Storage heaters, with capacity < 140,000 btu/hr, the storage volume should be <= 120 gallons.  "`
              - set has_fault to true: `has_fault = true`
            - the capacity per volume should be < 4000 btu/hr/gallon: `if capacity_per_volume >= 4000:`
              - add the following text to the note: "For Oil Storage heaters, with capacity < 140,000 btu/hr, the capacity per volume should be < 4000 btu/hr/gallon.": `rule_note += "For Oil Storage heaters, with capacity < 140,000 btu/hr, the capacity per volume should be < 4000 btu/hr/gallon.  "`
              - set has_fault to true: `has_fault = true`
            - the setpoint temperature should be less than or equal to 180F: `if shw_eq.setpoint_temperature > 180:`
              - add the following text to the note: "For Oil Storage Water heaters, the supply water temperature must be <= 180F": `rule_note += "For Oil Storage Water heaters, the supply water temperature must be <= 180F"`
              - set has_fault to true: `has_fault = true`
            - check if the actual uniform_energy_factor is >= to the expected: `if shw_eq.uniform_energy_factor >= expected_UEF && !has_faults:`
              - set rule_status to "PASS": `rule_status = "PASS"`
          - else the input capacity is >= 140,000 btu/hr: `else:`
            - the capacity per volume should be < 4000 btu/hr/gallon: `if capacity_per_volume >= 4000:`
              - add the following text to the note: "For Oil Storage heaters, with capacity > 140,000 btu/hr, the capacity per volume should be < 4000 btu/hr/gallon.": `rule_note += "For Oil Storage heaters, with capacity < 140,000 btu/hr, the capacity per volume should be < 4000 btu/hr/gallon.  "`
              - set has_fault to true: `has_fault = true`
            - set the expected thermal efficiency to 0.8: `expected_thermal_efficiency = 0.8`
            - check if the actual uniform_energy_factor is >= to the expected: `if shw_eq.thermal_efficiency >= expected_thermal_efficiency && !has_faults:`
              - set rule_status to "PASS": `rule_status = "PASS"`
        
     **Rule Assertion - Zone:**
    - Case1: type is INSTANTANEOUS - there is no baseline instantaneous water heater types: `if type == "INSTANTANEOUS": UNDETERMINED; rule_node = "There baseline water heater is of an Instantaneous type.  There are no acceptable instantaneous baseline water heaters in Table G3.1.1-2."
    - Case2: rule_status is PASS: `if rule_status == "PASS": PASS`.
    - Case3: rule_status is UNDETERMINED, UNDETERMINED & return rule_note: `elif rule_status == "UNDETERMINED": UNDETERMINED; rule_note`
    - Case4: rule_status is FAIL, FAIL & return rule_note: `elif rule_status == "FAIL": FAIL; rule_note`


**Notes:**

1. standby loss calculated based on https://www.energy.ca.gov/sites/default/files/2021-11/CBECC-Res_UserManual_2019.2.0_ada.pdf 9.6.4.8
2. what category to use of fuel type is Propane? Gas or Oil?
3. how to calculate the subcategory or rating condition (btu/hr/gallon) to confirm that this requirement is met?
4. draw_pattern - not currently included in the schema, but could be inferred from first_hour_rating based on Table I on page 9: https://www.govinfo.gov/content/pkg/CFR-2016-title10-vol3/pdf/CFR-2016-title10-vol3-part430-subpartB-appE.pdf
5. This question was discussed on 5/29/2024 and agreed that this exception wouldn't be triggered by a baseline system.  Original question: Would the exception to 7.4.2 ever be applicable to a baseline system?  The exceptions is: "All water heaters and hot-water supply boilers having more than 140 gal of storage capacity are not required to meet the standby loss (SL) requirements of Table 7.8 when 
    1. the tank surface is thermally insulated to R-12.5,
    2. a standing pilot light is not installed, and
    3. gas- or oil-fired storage water heaters have a flue damper or fan-assisted combustion.

**[Back](../_toc.md)**
