# Airside System - Rule 4-11  
**Schema Version:** 0.0.12  
**Mandatory Rule:** True  
**Rule ID:** 4-11    
 
**Rule Description:** Fan Schedules may be allowed to differ when Section G3.1.1(c) applies, i.e. baseline HVAC system type 3 or 4 has been used for spaces (zones) that differ by more than 40 equivalent full load hrs/week from other spaces (zones) served by the system or when the total peak internal gains that differ by 10 Btu/h·ft2 or more from the average of other HVAC zones served by the system.  

**Rule Assertion:** P-RMR = B-RMR                                           
**Appendix G Section:** Table G3.1 Section 4 Baseline Exception 3  
**Appendix G Section Reference:** None  
**Data Lookup:** None  
**Evaluation Context:** Evaluate each HeatingVentilationAirAconditioningSystem data table   

**Applicability Checks:** 

1. Applies when baseline HVAC system type 3 or 4 has been used for spaces (zones) that differ by more than 40 equivalent full load hrs/week from other spaces (zones) served by the system or when the total peak internal gains that differ by 10 Btu/h·ft2 or more from the average of other HVAC zones served by the system.    

**Function Call:** 

1. get_baseline_system_types()     
2. gget_aggregated_zone_hvac_fan_operating_schedule_p()  
3. match_data_element()  
4. get_dict_of_zones_hvac_sys_serving_specific_floor()  
5. get_list_hvac_systems_associated_with_zone()
6. get_hvac_zone_list_w_area()

## Rule Logic:  
**Applicability Check 1:**  
- Get dictionary for finding baseline system types for hvac systems: `baseline_hvac_sys_type_ids_dict_b = get_baseline_system_types(B_RMR)`
- Get dictionary with list of zones associated with each HVAC system: `dict_hvac_sys_zones_served_p = get_hvac_zone_list_w_area(P_RMR)`
- For each zone in the P_RMR: `for zone_p in P_RMR...Zone:`
    - Reset schedule mismatch variable which is used to track if the schedules mismatches: `schedule_mismatch = FALSE`
    - Get the aggregated fan operating schedule for the proposed to compare to the baseline fan schedule: `hvac_p = get_aggregated_zone_hvac_fan_operating_schedule_p(zone_p.id, P_RMR)`
    - Get hvac system with the longest fan operating schedule in the baseline to compare to proposed (should only be one system in the baseline but just in case we look for the longest): `hvac_b = get_hvac_system_with_longest_fan_schedule(match_data_element(B_RMR,Zone,zone_p.id).id, B_RMR)`
    - Get fan schedule associated with the longest fan operating schedule in the proposed to compare to baseline (if needed use a function to convert schedule to hourly values if it is an event schedule): `fan_schedule_p = hvac_p.fan_systems[0].operating_schedule.hourly_values`
    - Get fan schedule associated with the baseline system (if needed use a function to convert schedule to hourly values if it is an event schedule): `fan_schedule_b = hvac_b.fan_systems[0].operating_schedule.hourly_values` 
    - Loop through each hour of the schedules and compare across the B_RMR and P_RMR, : `for x in len(fan_schedule_b):`
        - Check if schedules matches for each hour of the year, if there is a mismatch then set the schedule_mismatch boolean variable equal to TRUE and carry out the other logic below: `if fan_schedule_b.hourly_values(x) != fan_schedule_p.hourly_values(x):`  
            - Set schedule_mismatch boolean variable to TRUE: `schedule_mismatch = TRUE`
    - Check if the schedule_mismatch boolean variable is equal to TRUE, if it is then carry out indented logic: `if schedule_mismatch == TRUE:`
        - Reset hvac type check (set to true below if there is a system type 5,6,7, or 8 on the floor) boolean variable to FALSE: `hvac_type_check = FALSE`
        - Reset proposed served by multizone boolean variable to FALSE: `proposed_served_by_multizone = FALSE`
        - Get the baseline system type: `hvac_sys_type_b = baseline_hvac_sys_type_ids_dict_b.keys()[list(baseline_hvac_sys_type_ids_dict_b.values()).index(hvac_b.id)]`
        - Check if system type is 3 or 4, if it is then continue with indented logic: `if hvac_sys_type_b in ["SYS-3","SYS-3a","SYS-3b, SYS-4"]:`
            - Get the floor name associated with the zone: `floor_name = match_data_element(B_RMR,Zone,zone_p.id).floor_name`
            - Get dictionary of zones and hvac systems associated with the floor name: `dict_of_zones_hvac_systems_serving_specific_floor = get_dict_of_zones_hvac_sys_serving_specific_floor(floor_name,B_RMR)`
            - Create list of hvac system serving the floor from the dictionary: `list_hvac_sys_serving_floor = list(dict_of_zones_hvac_systems_serving_specific_floor.values())`
            - Loop through and check if any systems are of type 5, 5b, 6, 6b, 7, 7a, 7b, 7c, 8, 8a, 8b, 8c: `for hvac_flr in list_hvac_sys_serving_floor:`
                - Check if the system is of type 5, 5b, 6, 6b, 7, 7a, 7b, 7c, 8, 8a, 8b, 8c: `if baseline_hvac_sys_type_ids_dict_b.keys()[list(baseline_hvac_sys_type_ids_dict_b.values()).index(hvac_flr.id)] in ["SYS-5","SYS-5b","SYS-6, SYS-6b", SYS-7",SYS-7a",SYS-7b",SYS-7c",SYS-8",SYS-8a",SYS-8b",SYS-8c"]:`
                    - Set hvac_type_check boolean variable to TRUE: `hvac_type_check = TRUE`  
            - Check if there is system types 5,6,7,8 on the floor via the hvac_type_check boolean variable, if true then check if the proposed zone is served by a multizone HVAC system: `if hvac_type_check == TRUE:`
                - Check if the zone is served by a multizone system in the proposed by first getting the list of hvac systems serving the zone in the proposed: `list_hvac_systems_p = get_list_hvac_systems_associated_with_zone(P_RMR, zone_p.id)`
                - Loop through each hvac system and check if any serve multiple zones: `for hvac_pr in list_hvac_systems_p:`
                    - Check if the hvac system serves more than one zone: `if len(list(dict_hvac_sys_zones_served_p[hvac_pr.id]["Zone_List"].values())) > 1:`
                        - Loop through terminal units associated with the zone to determine which is/are served by this HVAC system and check if it has reheat: `for terminal_p in zone_p.terminals:`
                            - Check if the terminal unit is served by the HVAC system: `if terminal_p.served_by_heating_ventilation_air_conditioning_system == hvac_pr.id:`
                                - Check if it has reheat, if it does then assume its a multizone unit and set the proposed served by multizone boolean variable to TRUE: `if terminal_p.heating_capacity >0:proposed_served_by_multizone = TRUE`   
                                
    **Rule Assertion:**
    - Case 1: For each applicable zone, if no schedule mismatch is observed then pass: `if schedule_mismatch == FALSE: PASS`
    - Case 2: Else if, there is a fan schedule mismatch but Section G3.1.1(c) appears to apply then Pass: `Elif schedule_mismatch == TRUE AND hvac_type_check == TRUE AND proposed_served_by_multizone == TRUE: PASS and raise_message "THERE IS A SCHEDULE MISMATCH BETWEEN THE BASELINE AND PROPOSED BUT SECTION G3.1.1(c) APPEARS APPLICABLE. VERIFY THAT THE FAN OPERATING SCHEDULE IN THE BASELINE IS IN ALIGNMENT WITH THE OCCUPANCY SCHEDULES."`
    - Case 3: Else, fail: `Else: FAIL and raise_message "THERE IS A FAN SCHEDULE MISMATCH BETWEEN THE BASELINE AND PROPOSED RMRs FOR THE HVAC SYSTEM(S) SERVING THIS ZONE. FAIL UNLESS TABLE G3.1 SECTION 4 BASELINE COLUMN EXCEPTIONS #1 or #2 IS APPLICABLE"`  


 **[Back](../_toc.md)**